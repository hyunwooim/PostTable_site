"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[535],{535:function(e,l,a){a.r(l),a.d(l,{default:function(){return U}});var t=a(6768),o=a(5130),n=a(4232);const u={class:"gallery-container"},s={class:"gallery-header"},c={class:"date-filter"},p=["onClick","src"],i={key:0,class:"popup"},r={class:"popup-content"},d={class:"popup-actions"},g={key:1,class:"popup",style:{"z-index":"3"}},v={class:"popup-content popup-image-detail"},m={class:"popup-left"},k={class:"wrapper"},h={class:"carousel-container"},f=["src"],L={class:"flicking-arrow-prev"},w={class:"flicking-arrow-next"},b={class:"popup-right"},C={class:"popup-footer"};function y(e,l,a,y,I,P){const D=(0,t.g2)("flicking");return(0,t.uX)(),(0,t.CE)("div",u,[(0,t.Lk)("header",s,[l[10]||(l[10]=(0,t.Lk)("h1",null,"Gallery",-1)),(0,t.Lk)("button",{class:"btn",onClick:l[0]||(l[0]=(...e)=>y.openUploadPopup&&y.openUploadPopup(...e))},"Upload")]),(0,t.Lk)("div",c,[(0,t.Lk)("label",null,[l[11]||(l[11]=(0,t.eW)("From: ")),(0,t.bo)((0,t.Lk)("input",{type:"date","onUpdate:modelValue":l[1]||(l[1]=e=>y.fromDate=e)},null,512),[[o.Jo,y.fromDate]])]),(0,t.Lk)("label",null,[l[12]||(l[12]=(0,t.eW)("To: ")),(0,t.bo)((0,t.Lk)("input",{type:"date","onUpdate:modelValue":l[2]||(l[2]=e=>y.toDate=e)},null,512),[[o.Jo,y.toDate]])])]),(0,t.Lk)("section",{class:"gallery-grid",onChange:l[3]||(l[3]=(...l)=>e.handleSelectChange&&e.handleSelectChange(...l))},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(y.flatFilteredImages,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"gallery-item"},[(0,t.Lk)("img",{onClick:l=>y.openImagePopup(e),src:`/file/photo/${e.images[0].id}${e.images[0].format}`},null,8,p)])))),128))],32),y.showPopup?((0,t.uX)(),(0,t.CE)("div",i,[(0,t.Lk)("div",r,[l[14]||(l[14]=(0,t.Lk)("h2",null,"Upload Image",-1)),(0,t.Lk)("form",{onSubmit:l[7]||(l[7]=(0,o.D$)(((...e)=>y.handleUpload&&y.handleUpload(...e)),["prevent"]))},[(0,t.Lk)("input",{type:"file",accept:"image/png, image/jpeg, image/gif",onChange:l[4]||(l[4]=(...e)=>y.handleFileChange&&y.handleFileChange(...e)),multiple:""},null,32),(0,t.bo)((0,t.Lk)("textarea",{"onUpdate:modelValue":l[5]||(l[5]=e=>y.newImageDescription=e),placeholder:"Enter description"},null,512),[[o.Jo,y.newImageDescription]]),(0,t.Lk)("div",d,[(0,t.Lk)("button",{class:"cncl_btn",type:"button",onClick:l[6]||(l[6]=(...e)=>y.closeUploadPopup&&y.closeUploadPopup(...e))},"Cancel"),l[13]||(l[13]=(0,t.Lk)("button",{class:"btn",type:"submit"},"Upload",-1))])],32)])])):(0,t.Q3)("",!0),y.showImagePopup?((0,t.uX)(),(0,t.CE)("div",g,[(0,t.Lk)("div",v,[(0,t.Lk)("div",m,[(0,t.Lk)("div",k,[(0,t.Lk)("div",h,[(0,t.bF)(D,{onReady:y.onFlickingSelected,onChanged:y.onFlickingSelected,options:{renderOnlyVisible:!0},plugins:y.flickingPlugins,style:{"max-width":"800px",position:"relative"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(y.selectedImage.images,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"flicking-panel"},[(0,t.Lk)("img",{src:`/file/photo/${e.id}${e.format}`,class:"gallery-popup-item"},null,8,f)])))),128))])),_:1},8,["onReady","onChanged","plugins"]),(0,t.Lk)("button",L,(0,n.v_)(y.prevArrowWord),1),(0,t.Lk)("button",w,(0,n.v_)(y.nextArrowWord),1)])])]),(0,t.Lk)("div",b,[(0,t.Lk)("h4",null,(0,n.v_)(y.selectedImage.date),1),(0,t.Lk)("h6",null,(0,n.v_)(y.selectedImage.description),1),(0,t.Lk)("div",C,[(0,t.Lk)("button",{class:"del_btn",onClick:l[8]||(l[8]=e=>y.deleteImage(y.selectedImage))},"delete"),(0,t.Lk)("button",{class:"btn",onClick:l[9]||(l[9]=(...e)=>y.closeImagePopup&&y.closeImagePopup(...e))},"Close")])])])])):(0,t.Q3)("",!0)])}a(4114),a(8111),a(2489),a(7588);var I=a(2180),P=(a(6635),a(144)),D=a(788),R=a.n(D),K=a(4974),E={name:"GalleryView",components:{Flicking:I.Ay},setup(){const e=(0,P.KR)({}),l=(0,P.KR)(!1),a=(0,P.KR)(!1),o=(0,P.KR)(null),n=(0,P.KR)(null),u=(0,P.KR)(""),s=(0,P.KR)(""),c=(0,P.KR)(""),p=(0,P.KR)(null),i=(0,P.KR)(null),r=(0,P.KR)([]),d=(0,P.KR)(""),g=(0,P.KR)(""),v=(0,P.KR)(!1),m=(0,P.KR)(!1),k=(0,P.KR)(null),h=()=>{e.value={},R().get("/api/photo/get").then((l=>{const a=l.data;a.forEach((l=>{const[a,t,o]=l.createdAtDate.split("-");e.value[a]||(e.value[a]={}),e.value[a][t]||(e.value[a][t]={}),e.value[a][t][o]||(e.value[a][t][o]=[]),e.value[a][t][o].push(l)}))})).catch((e=>console.error("이미지 불러오는데 실패했습니다:",e)))};console.log(e.value);const f=e=>{console.log(e.currentTarget,o.value.images.length);let l=e.currentTarget.index;0==l&&1==o.value.images.length?(d.value="",g.value=""):0!=l&&e.index!=o.value.images.length-1&&o.value.images.length>1?(d.value="<",g.value=">"):l==o.value.images.length-1&&o.value.images.length>1?(d.value="<",g.value=""):0==l&&o.value.images.length>1&&(d.value="",g.value=">")},L=e=>{o.value=e,a.value=!0,(0,t.dY)((()=>{r.value=[new K.i3({parentEl:document.querySelector(".carousel-container"),prevEl:".flicking-arrow-prev",nextEl:".flicking-arrow-next",classPrefix:""})],(0,t.dY)((()=>{const e=k.value?.getInstance?.();if(e){const l=()=>{v.value=e.canMovePrev(),m.value=e.canMoveNext()};e.on("moveEnd",l),e.on("ready",l),l()}}))}))},w=()=>a.value=!1,b=e=>{n.value=e.target.files},C=()=>{l.value=!0},y=()=>{l.value=!1},D=()=>{if(n.value){let e=new FormData;for(let l=0;l<n.value.length;l++)e.append("file",n.value[l]);e.append("description",u.value.replace(/\n/g,"<br>")),e.append("token",localStorage.getItem("jwtToken")),console.log(e),R().post("/api/photo/upload/",e,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{console.log("이미지 업로드 성공:",e.data),y(),h()})).catch((e=>console.error("이미지 업로드 실패:",e)))}},E=e=>{console.log(e),R()["delete"]("/api/photo/delete",{data:e}).then((e=>{console.log(e.data),w(),h()})).catch((e=>console.error("이미지 삭제 실패:",e)))},x=e=>s.value||c.value?e.filter((e=>{const l=new Date(e.createdAtDate),a=s.value?new Date(s.value):null,t=c.value?new Date(c.value):null;return!(a&&l<a)&&!(t&&l>t)})):e,F=(0,t.EW)((()=>{const l=[];return Object.values(e.value).forEach((e=>Object.values(e).forEach((e=>Object.values(e).forEach((e=>l.push(...x(e)))))))),l.sort(((e,l)=>new Date(l.createdAtDate+"T"+l.createdAtTime)-new Date(e.createdAtDate+"T"+e.createdAtTime))),l}));return(0,t.sV)((()=>{h()})),{closeUploadPopup:y,list:[1,2,3,4,5],images:e,showPopup:l,showImagePopup:a,selectedImage:o,handleFileChange:b,handleUpload:D,openImagePopup:L,closeImagePopup:w,deleteImage:E,fromDate:s,toDate:c,filteredImages:x,Flicking:I.Ay,flatFilteredImages:F,flickingPlugins:r,openUploadPopup:C,newImageDescription:u,arrowPrev:p,arrowNext:i,canGoPrev:v,canGoNext:m,prevArrowWord:d,nextArrowWord:g,onFlickingSelected:f,flickingRef:k}}},x=a(1241);const F=(0,x.A)(E,[["render",y],["__scopeId","data-v-32eef610"]]);var U=F}}]);
//# sourceMappingURL=535.3b7169bd.js.map